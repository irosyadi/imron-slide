<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Imron Rosyadi">

<title>Signals and Systems – Signal and Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Signal and Systems</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#signals-and-systems" id="toc-signals-and-systems" class="nav-link active" data-scroll-target="#signals-and-systems">Signals and Systems</a>
  <ul class="collapse">
  <li><a href="#causal-lti-systems-described-by-differential-and-difference-equations" id="toc-causal-lti-systems-described-by-differential-and-difference-equations" class="nav-link" data-scroll-target="#causal-lti-systems-described-by-differential-and-difference-equations">2.4 Causal LTI Systems Described by Differential and Difference Equations</a></li>
  <li><a href="#system-description-using-equations" id="toc-system-description-using-equations" class="nav-link" data-scroll-target="#system-description-using-equations">System Description using Equations</a></li>
  <li><a href="#implicit-system-specification" id="toc-implicit-system-specification" class="nav-link" data-scroll-target="#implicit-system-specification">Implicit System Specification</a></li>
  <li><a href="#auxiliary-conditions-and-initial-rest" id="toc-auxiliary-conditions-and-initial-rest" class="nav-link" data-scroll-target="#auxiliary-conditions-and-initial-rest">Auxiliary Conditions and Initial Rest</a></li>
  <li><a href="#solving-first-order-lccde-example-2.14" id="toc-solving-first-order-lccde-example-2.14" class="nav-link" data-scroll-target="#solving-first-order-lccde-example-2.14">Solving First-Order LCCDE: Example 2.14</a></li>
  <li><a href="#example-2.14-finding-the-particular-solution" id="toc-example-2.14-finding-the-particular-solution" class="nav-link" data-scroll-target="#example-2.14-finding-the-particular-solution">Example 2.14: Finding the Particular Solution</a></li>
  <li><a href="#example-2.14-finding-the-homogeneous-solution" id="toc-example-2.14-finding-the-homogeneous-solution" class="nav-link" data-scroll-target="#example-2.14-finding-the-homogeneous-solution">Example 2.14: Finding the Homogeneous Solution</a></li>
  <li><a href="#example-2.14-total-solution-and-initial-rest" id="toc-example-2.14-total-solution-and-initial-rest" class="nav-link" data-scroll-target="#example-2.14-total-solution-and-initial-rest">Example 2.14: Total Solution and Initial Rest</a></li>
  <li><a href="#example-2.14-output-signal-plot" id="toc-example-2.14-output-signal-plot" class="nav-link" data-scroll-target="#example-2.14-output-signal-plot">Example 2.14: Output Signal Plot</a></li>
  <li><a href="#general-nth-order-lccde" id="toc-general-nth-order-lccde" class="nav-link" data-scroll-target="#general-nth-order-lccde">General Nth-Order LCCDE</a></li>
  <li><a href="#linear-constant-coefficient-difference-equations-lccdes" id="toc-linear-constant-coefficient-difference-equations-lccdes" class="nav-link" data-scroll-target="#linear-constant-coefficient-difference-equations-lccdes">Linear Constant-Coefficient Difference Equations (LCCDEs)</a></li>
  <li><a href="#recursive-vs.-nonrecursive-systems" id="toc-recursive-vs.-nonrecursive-systems" class="nav-link" data-scroll-target="#recursive-vs.-nonrecursive-systems">Recursive vs.&nbsp;Nonrecursive Systems</a></li>
  <li><a href="#solving-first-order-lccde-example-2.15" id="toc-solving-first-order-lccde-example-2.15" class="nav-link" data-scroll-target="#solving-first-order-lccde-example-2.15">Solving First-Order LCCDE: Example 2.15</a></li>
  <li><a href="#example-2.15-impulse-response-of-an-iir-system" id="toc-example-2.15-impulse-response-of-an-iir-system" class="nav-link" data-scroll-target="#example-2.15-impulse-response-of-an-iir-system">Example 2.15: Impulse Response of an IIR System</a></li>
  <li><a href="#block-diagram-representations" id="toc-block-diagram-representations" class="nav-link" data-scroll-target="#block-diagram-representations">Block Diagram Representations</a></li>
  <li><a href="#discrete-time-first-order-system-block-diagram" id="toc-discrete-time-first-order-system-block-diagram" class="nav-link" data-scroll-target="#discrete-time-first-order-system-block-diagram">Discrete-Time First-Order System Block Diagram</a></li>
  <li><a href="#basic-elements-of-block-diagram" id="toc-basic-elements-of-block-diagram" class="nav-link" data-scroll-target="#basic-elements-of-block-diagram">Basic Elements of Block Diagram</a></li>
  <li><a href="#basic-operations-for-continuous-time-systems" id="toc-basic-operations-for-continuous-time-systems" class="nav-link" data-scroll-target="#basic-operations-for-continuous-time-systems">Basic Operations for Continuous-Time Systems</a></li>
  <li><a href="#continuous-time-first-order-system-block-diagram" id="toc-continuous-time-first-order-system-block-diagram" class="nav-link" data-scroll-target="#continuous-time-first-order-system-block-diagram">Continuous-Time First-Order System Block Diagram</a></li>
  <li><a href="#basic-elements-of-block-diagram-1" id="toc-basic-elements-of-block-diagram-1" class="nav-link" data-scroll-target="#basic-elements-of-block-diagram-1">Basic Elements of Block Diagram</a></li>
  <li><a href="#continous-system-in-differential-equations" id="toc-continous-system-in-differential-equations" class="nav-link" data-scroll-target="#continous-system-in-differential-equations">Continous System in Differential Equations</a></li>
  <li><a href="#continous-system-in-differential-equations-1" id="toc-continous-system-in-differential-equations-1" class="nav-link" data-scroll-target="#continous-system-in-differential-equations-1">Continous System in Differential Equations</a></li>
  <li><a href="#discrete-system-in-difference-equations" id="toc-discrete-system-in-difference-equations" class="nav-link" data-scroll-target="#discrete-system-in-difference-equations">Discrete System in Difference Equations</a></li>
  <li><a href="#spring-mass-system-with-numerical-integration" id="toc-spring-mass-system-with-numerical-integration" class="nav-link" data-scroll-target="#spring-mass-system-with-numerical-integration"><strong>Spring-Mass System with Numerical Integration</strong></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ss_24.html"><i class="bi bi-file-slides"></i>RevealJS (live)</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Signals and Systems</h1>
<p class="subtitle lead">2.4 Causal LTI Systems Described by Differential and Difference Equations</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Imron Rosyadi </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="signals-and-systems" class="level1">
<h1>Signals and Systems</h1>
<section id="causal-lti-systems-described-by-differential-and-difference-equations" class="level2">
<h2 class="anchored" data-anchor-id="causal-lti-systems-described-by-differential-and-difference-equations">2.4 Causal LTI Systems Described by Differential and Difference Equations</h2>
<hr>
</section>
<section id="system-description-using-equations" class="level2">
<h2 class="anchored" data-anchor-id="system-description-using-equations">System Description using Equations</h2>
<ul>
<li><strong>Continuous-time systems</strong> are often described by Linear Constant-Coefficient <strong>Differential</strong> Equations (LCCDEs).
<ul>
<li>Examples: RC circuits (Figure 1.1), vehicle motion (Figure 1.2), mechanical systems with restoring and damping forces.</li>
</ul></li>
<li><strong>Discrete-time systems</strong> are often described by Linear Constant-Coefficient <strong>Difference</strong> Equations (LCCDEs).
<ul>
<li>Examples: Bank account accumulation (Example 1.10), digital simulations, signal processing filters (e.g., differencing, averaging filters).</li>
</ul></li>
</ul>
<div class="notes">
<p>Today, we delve into a foundational aspect of Signals and Systems: how we mathematically model systems using differential and difference equations. These equations are not just abstract mathematical constructs; they are the language we use to describe a vast array of real-world engineering phenomena. Think of an RC circuit, where the capacitor’s voltage changes based on the input current and its own past charge, or a vehicle’s speed evolving under the influence of applied forces and friction. All these are elegantly captured by differential equations. Similarly, in the digital realm, from a simple moving average filter to complex control algorithms, difference equations provide the framework for understanding and designing discrete-time systems. Understanding how to interpret and solve these equations is crucial for analyzing system behavior.</p>
</div>
<hr>
</section>
<section id="implicit-system-specification" class="level2">
<h2 class="anchored" data-anchor-id="implicit-system-specification">Implicit System Specification</h2>
<ul>
<li>Differential and difference equations provide an <strong>implicit specification</strong> of system behavior.
<ul>
<li>They describe a <em>relationship</em> between the input (<span class="math inline">\(x(t)\)</span> or <span class="math inline">\(x[n]\)</span>) and the output (<span class="math inline">\(y(t)\)</span> or <span class="math inline">\(y[n]\)</span>), rather than an explicit expression.</li>
</ul></li>
<li><strong>Example: First-order LCCDE</strong> <span class="math display">\[
\frac{d y(t)}{d t}+2 y(t)=x(t) \tag{2.95}
\]</span>
<ul>
<li>This equation relates the rate of change of <span class="math inline">\(y(t)\)</span> and <span class="math inline">\(y(t)\)</span> itself to <span class="math inline">\(x(t)\)</span>.</li>
<li>It doesn’t directly tell us what <span class="math inline">\(y(t)\)</span> is for a given <span class="math inline">\(x(t)\)</span>.</li>
</ul></li>
</ul>
<div class="notes">
<p>It’s important to understand that these equations are <em>not</em> direct formulas for the output. They don’t simply say “y equals this function of x”. Instead, they describe a constraint or a rule that the input and output must satisfy together. For instance, the equation shown on the slide states that the sum of the output’s rate of change and twice the output itself must equal the input. To get an explicit formula for <span class="math inline">\(y(t)\)</span>, we need to <em>solve</em> this differential equation. This implicit nature is key to understanding why solving these equations requires specific techniques and additional information.</p>
</div>
<hr>
</section>
<section id="auxiliary-conditions-and-initial-rest" class="level2">
<h2 class="anchored" data-anchor-id="auxiliary-conditions-and-initial-rest">Auxiliary Conditions and Initial Rest</h2>
<ul>
<li>To find an <strong>explicit expression</strong> for the output, we must solve the differential or difference equation.</li>
<li>Solving requires more information than the equation alone: <strong>auxiliary conditions</strong>.
<ul>
<li>E.g., initial speed of a car, initial voltage across a capacitor.</li>
</ul></li>
<li>Different auxiliary conditions lead to different input-output relationships.</li>
<li>For <strong>Causal LTI systems</strong>, the auxiliary conditions typically take the form of the <strong>condition of initial rest</strong>.
<ul>
<li>If the input <span class="math inline">\(x(t)=0\)</span> for <span class="math inline">\(t &lt; t_0\)</span>, then the output <span class="math inline">\(y(t)\)</span> must also be 0 for <span class="math inline">\(t &lt; t_0\)</span>.</li>
<li>This implies specific initial conditions at <span class="math inline">\(t_0\)</span>, e.g., <span class="math inline">\(y(t_0)=0\)</span> (and its derivatives for higher-order systems).</li>
</ul></li>
</ul>
<div class="notes">
<p>Imagine trying to predict where a car will be after 10 seconds of constant acceleration. You can’t just know the acceleration; you also need to know its starting position and speed. Similarly, for an RC circuit, knowing the applied voltage isn’t enough; you need the initial capacitor voltage. These “starting values” are our auxiliary conditions. For most systems we study in Signals and Systems, particularly those that are Linear, Time-Invariant, and Causal – which we’ll call LTI-C systems for short – we employ a standard auxiliary condition called “initial rest.” This condition essentially states that if the system has not been acted upon by an input before a certain time, its output, and all its internal “memory” elements, must be zero up to that time. This condition is crucial because it makes the system unique, causal, and LTI. It ensures that the system’s response only begins when the input begins, and that the system “remembers” its past only via the input it has received, not through some arbitrary pre-existing state.</p>
</div>
<hr>
</section>
<section id="solving-first-order-lccde-example-2.14" class="level2">
<h2 class="anchored" data-anchor-id="solving-first-order-lccde-example-2.14">Solving First-Order LCCDE: Example 2.14</h2>
<p>Consider the system described by: <span class="math inline">\(\frac{d y(t)}{d t}+2 y(t)=x(t)\)</span> Let the input signal be: <span class="math inline">\(x(t)=K e^{3 t} u(t)\)</span></p>
<ul>
<li>The <strong>complete solution</strong> to a differential equation consists of two parts: <span class="math display">\[
y(t)=y_{p}(t)+y_{h}(t) \tag{2.97}
\]</span>
<ul>
<li><span class="math inline">\(y_p(t)\)</span>: <strong>Particular solution</strong> (or forced response). This part satisfies the full differential equation with the given input.</li>
<li><span class="math inline">\(y_h(t)\)</span>: <strong>Homogeneous solution</strong> (or natural response). This part is a solution to the homogeneous differential equation (with input set to zero): <span class="math display">\[
\frac{d y(t)}{d t}+2 y(t)=0 \tag{2.98}
\]</span></li>
</ul></li>
</ul>
<div class="notes">
<p>Let’s walk through an example to see how we solve these. We have a first-order differential equation modeling a system, and we’re applying an exponential input <code>x(t)</code>. The general approach to solving such an equation is to break the problem into two parts. First, we find the particular solution, which directly responds to the input signal. This is the forced part of the response. Second, we find the homogeneous solution, which describes the system’s inherent behavior—how it would react without any external input, or how it would ‘ring out’ if disturbed. This is often called the natural response. The total solution is simply the sum of these two components.</p>
</div>
<hr>
</section>
<section id="example-2.14-finding-the-particular-solution" class="level2">
<h2 class="anchored" data-anchor-id="example-2.14-finding-the-particular-solution">Example 2.14: Finding the Particular Solution</h2>
<ul>
<li><strong>For <span class="math inline">\(t&gt;0\)</span>, the input is <span class="math inline">\(x(t)=K e^{3 t}\)</span>.</strong></li>
<li>We hypothesize that the particular solution <span class="math inline">\(y_p(t)\)</span> will have the same exponential form as the input for <span class="math inline">\(t&gt;0\)</span>: <span class="math display">\[
y_{p}(t)=Y e^{3 t} \tag{2.99}
\]</span> where <span class="math inline">\(Y\)</span> is a coefficient to be determined.</li>
<li>Substitute <span class="math inline">\(y_p(t)\)</span> and <span class="math inline">\(x(t)\)</span> into the original differential equation (<span class="math inline">\(\frac{d y(t)}{d t}+2 y(t)=x(t)\)</span>) for <span class="math inline">\(t&gt;0\)</span>: <span class="math display">\[
\frac{d}{dt}(Y e^{3 t}) + 2 (Y e^{3 t}) = K e^{3 t}  \quad \implies \quad 3 Y e^{3 t}+2 Y e^{3 t}=K e^{3 t} \tag{2.100}
\]</span></li>
<li>Cancel <span class="math inline">\(e^{3 t}\)</span> from both sides, then solve for <span class="math inline">\(Y\)</span>: <span class="math display">\[
5 Y = K \implies Y = \frac{K}{5} \tag{2.101, 2.102}
\]</span></li>
<li>Thus, the particular solution for <span class="math inline">\(t&gt;0\)</span> is: <span class="math display">\[
y_{p}(t)=\frac{K}{5} e^{3 t}, \quad t&gt;0 \tag{2.103}
\]</span></li>
</ul>
<div class="notes">
<p>To find the particular solution when the input is an exponential, a common and effective strategy is to assume that the particular solution itself will be an exponential of the same form. So, for an input <code>K * e^(3t)</code>, we propose a particular solution <code>Y * e^(3t)</code>. We then substitute this proposed solution and the input back into the original differential equation. The derivative of <code>Y * e^(3t)</code> is <code>3Y * e^(3t)</code>. After substitution, we can factor out <code>e^(3t)</code> and solve for the unknown coefficient <code>Y</code>. In this case, we find <code>Y = K/5</code>. This gives us the part of the output that is directly “forced” by the input signal.</p>
</div>
<hr>
</section>
<section id="example-2.14-finding-the-homogeneous-solution" class="level2">
<h2 class="anchored" data-anchor-id="example-2.14-finding-the-homogeneous-solution">Example 2.14: Finding the Homogeneous Solution</h2>
<ul>
<li>Now, we need to find the homogeneous solution <span class="math inline">\(y_h(t)\)</span>, which satisfies the homogeneous differential equation: <span class="math display">\[
\frac{d y(t)}{d t}+2 y(t)=0 \tag{2.98}
\]</span></li>
<li>We hypothesize an exponential form for the homogeneous solution: <span class="math display">\[
y_{h}(t)=A e^{s t} \tag{2.104}
\]</span> where <span class="math inline">\(A\)</span> and <span class="math inline">\(s\)</span> are constants.</li>
<li>Substitute <span class="math inline">\(y_h(t)\)</span> into the homogeneous equation: <span class="math display">\[
\frac{d}{dt}(A e^{s t}) + 2 (A e^{s t}) = 0 \quad \implies \quad A s e^{s t}+2 A e^{s t}=0 \tag{2.105}
\]</span></li>
<li>Factor out <span class="math inline">\(A e^{s t}\)</span>: <span class="math display">\[
A e^{s t}(s+2)=0
\]</span></li>
<li>For this to be true for all <span class="math inline">\(t\)</span>, we must have <span class="math inline">\(s+2=0\)</span>, which implies <span class="math inline">\(s = -2\)</span>.</li>
<li>Therefore, the homogeneous solution is: <span class="math display">\[
y_{h}(t)=A e^{-2 t}
\]</span> where <span class="math inline">\(A\)</span> is an arbitrary constant determined by auxiliary conditions.</li>
</ul>
<div class="notes">
<p>Next, let’s find the homogeneous solution. This represents the system’s “natural” way of responding, independent of the specific input. We again assume an exponential form, <code>A * e^(st)</code>. When we substitute this into the homogeneous equation (where the input is zero), we find a condition for ‘s’. In this case, <code>s</code> must be -2. This means <code>A * e^(-2t)</code> is a valid solution to the homogeneous equation for any constant <code>A</code>. This <code>A</code> is the arbitrary constant that will be determined by our auxiliary or initial conditions. The <code>-2t</code> in the exponent indicates an exponentially decaying component, often related to the system’s stability or its natural frequency.</p>
</div>
<hr>
</section>
<section id="example-2.14-total-solution-and-initial-rest" class="level2">
<h2 class="anchored" data-anchor-id="example-2.14-total-solution-and-initial-rest">Example 2.14: Total Solution and Initial Rest</h2>
<ul>
<li><strong>Combine particular and homogeneous solutions to get the general solution for <span class="math inline">\(t&gt;0\)</span>:</strong> <span class="math display">\[
y(t)=A e^{-2 t}+\frac{K}{5} e^{3 t}, \quad t&gt;0 \tag{2.106}
\]</span></li>
<li><strong>Apply the condition of initial rest:</strong>
<ul>
<li>Since the input <span class="math inline">\(x(t)=K e^{3 t} u(t)\)</span> implies <span class="math inline">\(x(t)=0\)</span> for <span class="math inline">\(t&lt;0\)</span>, a causal LTI system will have <span class="math inline">\(y(t)=0\)</span> for <span class="math inline">\(t&lt;0\)</span>.</li>
<li>This means the initial condition is <span class="math inline">\(y(0)=0\)</span>.</li>
</ul></li>
<li><strong>Solve for <span class="math inline">\(A\)</span> using <span class="math inline">\(y(0)=0\)</span> in the general solution:</strong> <span class="math display">\[
0 = A e^{-2(0)} + \frac{K}{5} e^{3(0)}  \implies  0 = A + \frac{K}{5}  \implies  A = -\frac{K}{5}
\]</span></li>
<li><strong>Substitute <span class="math inline">\(A\)</span> back into the general solution to obtain the final, complete response:</strong> <span class="math display">\[
y(t)=\frac{K}{5} e^{3 t} - \frac{K}{5} e^{-2 t}, \quad t&gt;0
\]</span></li>
<li>Combining with <span class="math inline">\(y(t)=0\)</span> for <span class="math inline">\(t&lt;0\)</span>: <span class="math display">\[
y(t)=\frac{K}{5}\left[e^{3 t}-e^{-2 t}\right] u(t) \tag{2.108}
\]</span></li>
</ul>
<div class="notes">
<p>Now that we have both the particular and homogeneous solutions, we combine them to form the general solution. Notice that it still has an unknown constant <code>A</code>. This is where our auxiliary condition of “initial rest” comes into play. Since our input <code>x(t)</code> effectively starts at <code>t=0</code> (due to the <code>u(t)</code>), the condition of initial rest implies that the output <code>y(t)</code> must also be zero before <code>t=0</code>. Thus, we can set <code>y(0) = 0</code>. Plugging this into our general solution allows us to solve for <code>A</code>, making the solution unique. In this example, <code>A</code> turns out to be <code>-K/5</code>. With <code>A</code> determined, we have the complete and unique output <code>y(t)</code> for the given input and initial rest condition. This final form includes the unit step <code>u(t)</code> to correctly represent the causality, meaning the response starts at <code>t=0</code>.</p>
</div>
<hr>
</section>
<section id="example-2.14-output-signal-plot" class="level2">
<h2 class="anchored" data-anchor-id="example-2.14-output-signal-plot">Example 2.14: Output Signal Plot</h2>
<p><small>Adjust the input amplitude K and observe the output response. </small></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1" data-startfrom="182" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 181;"><span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>viewof K_slider <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;span style="font-size: 0.8em;"&gt;Amplitude K&lt;/span&gt;`</span><span class="op">,</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<pre class="{pyodide}"><code>#| echo: false
#| input: 
#| - K_slider
import numpy as np
import plotly.graph_objects as go

K = K_slider
t = np.linspace(-1, 3, 400)
x = K * np.exp(3 * t) * (t &gt;= 0)
y = (K / 5) * (np.exp(3 * t) - np.exp(-2 * t)) * (t &gt;= 0)

fig = go.Figure()
fig.add_trace(go.Scatter(x=t, y=x, mode='lines', name=f'Input x(t) = {K}e^(3t)u(t)'))
fig.add_trace(go.Scatter(x=t, y=y, mode='lines', name='Output y(t)'))
fig.update_layout(
    title=f'System Response for K={K}',
    xaxis_title='Time (t)',
    yaxis_title='Amplitude',
    yaxis_range=[0, 80000],
    height=400,
    margin=dict(t=50, b=50, l=50, r=50)
)
fig.show()</code></pre>
<div class="notes">
<p>Let’s visualize this. Here, you can change the amplitude ‘K’ of the input signal using the slider. Observe how the input signal <code>x(t)</code> starts at <code>t=0</code> and grows exponentially. The output <code>y(t)</code> also starts at <code>t=0</code>, due to initial rest. It initially grows because of the <code>e^(3t)</code> term from the input, but also incorporates the decaying <code>e^(-2t)</code> term from the system’s natural response. Notice how if you double K, the output also doubles, confirming the linearity of the system under initial rest conditions. This interactive plot helps us gain an intuitive understanding of how the system processes the input and how the different components of the solution manifest over time.</p>
</div>
<hr>
</section>
<section id="general-nth-order-lccde" class="level2">
<h2 class="anchored" data-anchor-id="general-nth-order-lccde">General Nth-Order LCCDE</h2>
<ul>
<li>A general <span class="math inline">\(N\)</span>th-order linear constant-coefficient differential equation is given by: <span class="math display">\[
\sum_{k=0}^{N} a_{k} \frac{d^{k} y(t)}{d t^{k}}=\sum_{k=0}^{M} b_{k} \frac{d^{k} x(t)}{d t^{k}} \tag{2.109}
\]</span>
<ul>
<li><span class="math inline">\(N\)</span> is the order of the system (highest derivative of <span class="math inline">\(y(t)\)</span>).</li>
<li>If <span class="math inline">\(N=0\)</span>, then <span class="math inline">\(y(t)=\frac{1}{a_{0}} \sum_{k=0}^{M} b_{k} \frac{d^{k} x(t)}{d t^{k}}\)</span>, which is an explicit function of <span class="math inline">\(x(t)\)</span> and its derivatives (no auxiliary conditions needed).</li>
</ul></li>
<li><strong>Solution approach:</strong> Still a sum of particular and homogeneous solutions.
<ul>
<li>Homogeneous equation: <span class="math inline">\(\sum_{k=0}^{N} a_{k} \frac{d^{k} y(t)}{d t^{k}}=0\)</span>.</li>
</ul></li>
<li><strong>Initial Rest Condition:</strong> For <span class="math inline">\(x(t)=0\)</span> for <span class="math inline">\(t \leq t_0\)</span>, the output <span class="math inline">\(y(t)=0\)</span> for <span class="math inline">\(t \leq t_0\)</span>. This requires the initial conditions: <span class="math display">\[
y\left(t_{0}\right)=\frac{d y\left(t_{0}\right)}{d t}=\ldots=\frac{d^{N-1} y\left(t_{0}\right)}{d t^{N-1}}=0 \tag{2.112}
\]</span></li>
</ul>
<div class="notes">
<p>The concepts we just covered for a first-order differential equation extend directly to more complex, higher-order systems. Equation 2.109 is the general form for an Nth-order LCCDE. The ‘N’ here refers to the highest derivative of the output <code>y(t)</code>. If <code>N</code> is zero, the equation simplifies, and <code>y(t)</code> becomes an explicit function of the input and its derivatives; in this highly simplified case, no auxiliary conditions are strictly needed. However, for <code>N</code> greater than or equal to 1, the output is implicitly defined, and we still follow the same strategy: finding particular and homogeneous solutions. For LTI-C systems, the initial rest condition applies, but for an Nth-order system, it means that a total of N initial conditions (the output and its first N-1 derivatives) must all be zero at the starting point <code>t0</code> where the input becomes non-zero. This provides the <code>N</code> constants needed to uniquely determine the full solution. We will later introduce more advanced tools like Laplace Transforms to greatly simplify the solution of these higher-order equations.</p>
</div>
<hr>
</section>
<section id="linear-constant-coefficient-difference-equations-lccdes" class="level2">
<h2 class="anchored" data-anchor-id="linear-constant-coefficient-difference-equations-lccdes">Linear Constant-Coefficient Difference Equations (LCCDEs)</h2>
<ul>
<li>The <strong>discrete-time counterpart</strong> to continuous-time LCCDEs is the <span class="math inline">\(N\)</span>th-order linear constant-coefficient difference equation: <span class="math display">\[
\sum_{k=0}^{N} a_{k} y[n-k]=\sum_{k=0}^{M} b_{k} x[n-k] \tag{2.113}
\]</span></li>
<li><strong>Solution approach:</strong> Analogous to differential equations – sum of a particular solution and a homogeneous solution.
<ul>
<li>Homogeneous equation: <span class="math inline">\(\sum_{k=0}^{N} a_{k} y[n-k]=0\)</span>.</li>
</ul></li>
<li><strong>Condition of Initial Rest:</strong> If <span class="math inline">\(x[n]=0\)</span> for <span class="math inline">\(n&lt;n_0\)</span>, then <span class="math inline">\(y[n]=0\)</span> for <span class="math inline">\(n&lt;n_0\)</span>.
<ul>
<li>Under the condition of initial rest, the system described by the difference equation is LTI and causal.</li>
</ul></li>
</ul>
<div class="notes">
<p>Just as differential equations describe continuous-time systems, difference equations are fundamental for discrete-time systems. Equation 2.113 is the general form. The solution methodology mirrors the continuous-time case: find a particular solution responding to the input, and a homogeneous solution representing the system’s natural behavior. And crucially, just as with differential equations, difference equations require auxiliary conditions for a unique solution. Again, for LTI and causal systems, we adopt the “initial rest” condition. This states that if the input is zero before a certain time <code>n0</code>, then the output must also be zero before <code>n0</code>. This ensures causality and preserves the LTI properties.</p>
</div>
<hr>
</section>
<section id="recursive-vs.-nonrecursive-systems" class="level2">
<h2 class="anchored" data-anchor-id="recursive-vs.-nonrecursive-systems">Recursive vs.&nbsp;Nonrecursive Systems</h2>
<p><strong>Recursive Equation (IIR)</strong></p>
<ul>
<li>If <span class="math inline">\(N \ge 1\)</span> (output depends on past outputs), the equation can be rearranged to directly compute <span class="math inline">\(y[n]\)</span>: <span class="math display">\[
y[n]=\frac{1}{a_{0}}\left\{\sum_{k=0}^{M} b_{k} x[n-k]-\sum_{k=1}^{N} a_{k} y[n-k]\right\} \tag{2.115}
\]</span></li>
<li>Output <span class="math inline">\(y[n]\)</span> depends on both <strong>current/past inputs</strong> and <strong>past outputs</strong>.</li>
<li>Requires auxiliary conditions (e.g., <span class="math inline">\(y[n_0-1], \ldots, y[n_0-N]\)</span>) to start the recursion.</li>
<li>Often leads to <strong>Infinite Impulse Response (IIR)</strong> systems.</li>
</ul>
<p><strong>Nonrecursive Equation (FIR)</strong></p>
<ul>
<li>In the special case when <span class="math inline">\(N = 0\)</span>: <span class="math display">\[
y[n]=\sum_{k=0}^{M}\left(\frac{b_{k}}{a_{0}}\right) x[n-k] \tag{2.116}
\]</span></li>
<li>Output <span class="math inline">\(y[n]\)</span> depends <strong>only on present and past inputs.</strong></li>
<li>No auxiliary conditions are directly needed, as output is explicit.</li>
<li>Always a <strong>Finite Impulse Response (FIR)</strong> system.
<ul>
<li>Its impulse response <span class="math inline">\(h[n]\)</span> has finite duration: <span class="math display">\[
h[n]= \begin{cases}\frac{b_{n}}{a_{0}}, &amp; 0 \leq n \leq M \\ 0, &amp; \text { otherwise }\end{cases} \tag{2.117}
\]</span></li>
</ul></li>
</ul>
<div class="notes">
<p>A significant distinction in discrete-time systems is between recursive and nonrecursive equations. If the current output <code>y[n]</code> depends on <em>past outputs</em> (i.e., N is greater than or equal to 1), the equation is recursive. This forms a feedback loop where past results influence current calculations. Because of this feedback, initial conditions are essential to kickstart the process, and such systems typically have an impulse response that goes on indefinitely, hence “Infinite Impulse Response” or IIR.</p>
<p>In contrast, if <code>N</code> is zero, the current output <code>y[n]</code> depends <em>only on current and past inputs</em>. This is a nonrecursive equation. There’s no feedback from the output back into the system. As a result, no auxiliary conditions are needed, and the impulse response is always finite in duration, making these “Finite Impulse Response” or FIR systems. FIR systems are simpler to analyze and design in certain contexts.</p>
</div>
<hr>
</section>
<section id="solving-first-order-lccde-example-2.15" class="level2">
<h2 class="anchored" data-anchor-id="solving-first-order-lccde-example-2.15">Solving First-Order LCCDE: Example 2.15</h2>
<p>Consider the difference equation: <span class="math inline">\(y[n]-\frac{1}{2} y[n-1]=x[n]\)</span><br>
Rearranging for recursive computation: <span class="math inline">\(y[n]=x[n]+\frac{1}{2} y[n-1]\)</span><br>
Let the input be an impulse: <span class="math inline">\(x[n]=K \delta[n]\)</span></p>
<ul>
<li><strong>Apply initial rest condition:</strong>
<ul>
<li>Since <span class="math inline">\(x[n]=0\)</span> for <span class="math inline">\(n&lt;-1\)</span>, initial rest implies <span class="math inline">\(y[n]=0\)</span> for <span class="math inline">\(n&lt;-1\)</span>.</li>
<li>Therefore, <span class="math inline">\(y[-1]=0\)</span>.</li>
</ul></li>
<li><strong>Iterative Solution for <span class="math inline">\(n \ge 0\)</span>:</strong>
<ul>
<li><span class="math inline">\(y[0] = x[0] + \frac{1}{2} y[-1] = K \delta[0] + \frac{1}{2}(0) = K\)</span></li>
<li><span class="math inline">\(y[1] = x[1] + \frac{1}{2} y[0] = K \delta[1] + \frac{1}{2} K = 0 + \frac{1}{2} K = \frac{1}{2} K\)</span></li>
<li><span class="math inline">\(y[2] = x[2] + \frac{1}{2} y[1] = K \delta[2] + \frac{1}{2} \left(\frac{1}{2} K\right) = 0 + \left(\frac{1}{2}\right)^2 K = \left(\frac{1}{2}\right)^2 K\)</span></li>
<li><span class="math inline">\(\vdots\)</span></li>
<li>In general, for <span class="math inline">\(n \ge 0\)</span>: <span class="math inline">\(y[n] = \left(\frac{1}{2}\right)^n K\)</span>.</li>
</ul></li>
<li><strong>Impulse Response (<span class="math inline">\(K=1\)</span>):</strong> <span class="math display">\[
h[n]=\left(\frac{1}{2}\right)^{n} u[n] \tag{2.125}
\]</span> This is an <strong>Infinite Impulse Response (IIR) system</strong>.</li>
</ul>
<div class="notes">
<p>Let’s see a discrete-time example. We have a first-order difference equation, rearranged into its recursive form to show that <span class="math inline">\(y[n]\)</span> depends on <span class="math inline">\(y[n-1]\)</span>. We apply an impulse input, <span class="math inline">\(K \delta[n]\)</span>. The initial rest condition means that before <code>n=0</code>, <code>y[n]</code> is zero, so <code>y[-1]</code> is zero. From there, we can iteratively calculate <code>y[n]</code> for <code>n=0, 1, 2, ...</code>.</p>
<p>At <code>n=0</code>, <code>y[0]</code> is <code>x[0]</code> plus half of <code>y[-1]</code>, which gives <code>K</code>. At <code>n=1</code>, <code>y[1]</code> is <code>x[1]</code> plus half of <code>y[0]</code>, which gives <code>(1/2)K</code>. This pattern continues, leading to <span class="math inline">\(y[n] = (1/2)^n K\)</span> for <code>n</code> greater than or equal to zero. If <code>K=1</code>, this directly gives us the impulse response <code>h[n] = (1/2)^n u[n]</code>. Since this response extends indefinitely, it confirms that this is an IIR system, characteristic of recursive difference equations.</p>
</div>
<hr>
</section>
<section id="example-2.15-impulse-response-of-an-iir-system" class="level2">
<h2 class="anchored" data-anchor-id="example-2.15-impulse-response-of-an-iir-system">Example 2.15: Impulse Response of an IIR System</h2>
<p><small>Observe the decaying impulse response for different coefficients. </small></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3" data-startfrom="326" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 325;"><span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>viewof alpha_slider <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="fl">0.9</span><span class="op">,</span> <span class="fl">0.9</span>]<span class="op">,</span> {</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;span style="font-size: 0.8em;"&gt;Coefficient 'a'&lt;/span&gt;`</span><span class="op">,</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<pre class="{pyodide}"><code>#| echo: false
#| input: 
#| - alpha_slider
import numpy as np
import plotly.graph_objects as go

alpha = alpha_slider
n = np.arange(0, 20) # Time indices
h = (alpha)**n * (n &gt;= 0) # Impulse response h[n] = a^n u[n]

fig = go.Figure()
fig.add_trace(go.Scatter(x=n, y=h, mode='lines+markers', name=f'h[n] for a={alpha:.1f}'))
fig.update_layout(
    title=f'Impulse Response h[n] = ({alpha:.1f})^n u[n]',
    xaxis_title='n (samples)',
    yaxis_title='Amplitude',
    yaxis_range=[-1, 1],
    height=400,
    margin=dict(t=50, b=50, l=50, r=50)
)
fig.show()</code></pre>
<div class="notes">
<p>Here’s an interactive visualization of the impulse response we just derived. The difference equation is <code>y[n] = x[n] + a*y[n-1]</code>. The impulse response is <code>h[n] = a^n u[n]</code>. You can adjust the coefficient ‘a’ using the slider. Notice how the shape of the impulse response changes: - When <code>a</code> is between 0 and 1 (like 0.5 in our example), the response decays exponentially, indicating a stable system. - When <code>a</code> is negative (e.g., -0.5), it oscillates while decaying. - If the absolute value of <code>a</code> is greater than or equal to 1, the response will not decay, indicating an unstable or marginally stable system.</p>
<p>This helps visualize why these are called Infinite Impulse Response (IIR) systems—the response theoretically continues indefinitely, though it can decay quickly depending on the value of ‘a’.</p>
</div>
<hr>
</section>
<section id="block-diagram-representations" class="level2">
<h2 class="anchored" data-anchor-id="block-diagram-representations">Block Diagram Representations</h2>
<ul>
<li>Representing systems using block diagrams offers several advantages:
<ul>
<li>Provides a <strong>pictorial representation</strong> for better intuitive understanding of system structure.</li>
<li>Useful for <strong>simulation</strong> (analog or digital computers).</li>
<li>Guides <strong>hardware implementation</strong> for physical systems.</li>
</ul></li>
<li><strong>Basic Operations for Discrete-Time Systems:</strong>
<ul>
<li><strong>Adder:</strong> Sums multiple input signals.</li>
<li><strong>Multiplier:</strong> Scales a signal by a constant coefficient.</li>
<li><strong>Unit Delay:</strong> Outputs the input from the <em>previous</em> time step. This is the <strong>memory element</strong>.</li>
</ul></li>
</ul>
<div class="notes">
<p>Moving beyond mathematical equations, block diagrams offer a powerful and intuitive way to visualize and implement systems. They break down a complex system into an interconnection of simple, fundamental operations. This not only enhances our understanding of how signals flow and are processed within the system but also provides a direct blueprint for how these systems could be simulated on computers or even built in hardware. For discrete-time systems, we use three basic building blocks: adders to combine signals, multipliers to scale them by coefficients, and crucially, a unit delay element, which serves as the system’s memory, holding onto a value from the previous time step.</p>
</div>
<hr>
</section>
<section id="discrete-time-first-order-system-block-diagram" class="level2">
<h2 class="anchored" data-anchor-id="discrete-time-first-order-system-block-diagram">Discrete-Time First-Order System Block Diagram</h2>
<p>System equation: <span class="math inline">\(y[n]+a y[n-1]=b x[n]\)</span><br>
Rearranged for direct computation: <span class="math inline">\(y[n] = -a y[n-1] + b x[n]\)</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    x_n("x[n]") --&gt; mult_b{b}
    mult_b --&gt; sum1("$$+$$")
    delay("$$z^{-1}$$") -- y[n-1] --&gt; mult_a{-a}
    mult_a --&gt; sum1
    sum1 -- y[n] --&gt; delay
    sum1 -- y[n] --&gt; y_n("y[n]")

    subgraph Operations
        sum1
        mult_b
        mult_a
        delay
    end
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li>The <strong>delay element</strong> (<span class="math inline">\(z^{-1}\)</span>) represents the system’s memory. Its initial state corresponds to the auxiliary condition <span class="math inline">\(y[-1]\)</span>.</li>
<li>This diagram clearly shows <strong>feedback</strong>, characteristic of recursive (IIR) systems.</li>
</ul>
<div class="notes">
<p>Let’s construct a block diagram for our first-order discrete-time difference equation: <code>y[n] = -a*y[n-1] + b*x[n]</code>. The term <code>b*x[n]</code> is created by multiplying the input <code>x[n]</code> by <code>b</code>. The term <code>-a*y[n-1]</code> is generated from the output <code>y[n]</code>. The output <code>y[n]</code> goes into a delay element, which stores <code>y[n-1]</code>. This <code>y[n-1]</code> is then multiplied by <code>-a</code>. Finally, these two terms (<code>b*x[n]</code> and <code>-a*y[n-1]</code>) are summed to produce the current output <code>y[n]</code>. Notice the feedback loop: the output <code>y[n]</code> is fed back through the delay and multiplier to influence future outputs. The delay element is explicitly where the system’s “memory” resides, and its initial stored value <code>y[-1]</code> is the necessary auxiliary condition. This feedback structure is a hallmark of recursive systems.</p>
</div>
<hr>
</section>
<section id="basic-elements-of-block-diagram" class="level2">
<h2 class="anchored" data-anchor-id="basic-elements-of-block-diagram">Basic Elements of Block Diagram</h2>
<p>For equation <span class="math inline">\(y[n] = -a*y[n-1] + b*x[n]\)</span> : (a) an adder; (b) multiplication by a coefficient; (c) a unit delay; (d) overall representation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=192&amp;width=636&amp;top_left_y=246&amp;top_left_x=397" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=77&amp;width=531&amp;top_left_y=564&amp;top_left_x=411" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=134&amp;width=545&amp;top_left_y=782&amp;top_left_x=414" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=309&amp;width=577&amp;top_left_y=1027&amp;top_left_x=472" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="4" type="a">
<li></li>
</ol>
<hr>
</section>
<section id="basic-operations-for-continuous-time-systems" class="level2">
<h2 class="anchored" data-anchor-id="basic-operations-for-continuous-time-systems">Basic Operations for Continuous-Time Systems</h2>
<ul>
<li>Similar basic elements found in continuous-time block diagrams:
<ul>
<li><strong>Adder:</strong> Sums multiple input signals.</li>
<li><strong>Multiplier:</strong> Scales a signal by a constant coefficient.</li>
</ul></li>
<li>Crucially, for continuous-time, instead of a differentiator (which is difficult to implement and sensitive to noise), we use an <strong>integrator</strong>.
<ul>
<li><strong>Integrator:</strong> <span class="math inline">\(\int_{-\infty}^{t} (\cdot) d\tau\)</span>. This is the <strong>memory storage element</strong> for continuous-time systems.</li>
</ul></li>
</ul>
<div class="notes">
<p>For continuous-time systems, the fundamental building blocks for block diagrams are similar: adders and multipliers. However, a key difference emerges when we deal with derivatives. While analytically we define systems with derivatives, practically, differentiators are very hard to build and are notoriously sensitive to noise amplification. Think about trying to build a circuit that perfectly differentiates a signal – any tiny bit of noise would be greatly exaggerated. So, for practical implementation and stable representations, we prefer to work with <em>integrators</em> instead. An integrator performs the inverse operation of differentiation, accumulating the input over time, and it naturally acts as the memory element in continuous-time systems, much like a capacitor storing charge.</p>
</div>
<hr>
</section>
<section id="continuous-time-first-order-system-block-diagram" class="level2">
<h2 class="anchored" data-anchor-id="continuous-time-first-order-system-block-diagram">Continuous-Time First-Order System Block Diagram</h2>
<p>System equation: <span class="math inline">\(\frac{d y(t)}{d t}+a y(t)=b x(t)\)</span><br>
Rearranged for integration: <span class="math inline">\(\frac{d y(t)}{d t}=b x(t)-a y(t)\)</span><br>
Integrate from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(t\)</span>: <span class="math inline">\(y(t)=\int_{-\varkappa}^{t}[b x(\tau)-a y(\tau)] d \tau\)</span></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    x_t("x(t)") --&gt; mult_b{b}
    mult_b --&gt; sum1("$$+$$")
    y_t("y(t)") --&gt; mult_a{-a}
    mult_a --&gt; sum1
    sum1 --&gt; intg("∫dτ")
    intg --&gt; y_t
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li>The <strong>integrator</strong> is the memory element, storing the accumulated signal.</li>
<li>The value <span class="math inline">\(y(t_0)\)</span> represents the initial condition stored by the integrator.</li>
<li>This representation is the basis for <strong>analog computer simulations</strong>.</li>
</ul>
<div class="notes">
<p>Let’s visualize the first-order continuous-time LCCDE. Instead of expressing <code>y(t)</code> directly, we rearrange the equation to isolate the derivative of <code>y(t)</code>. So, <code>dy(t)/dt = b*x(t) - a*y(t)</code>. If we integrate both sides from <code>negative infinity</code> to <code>t</code>, the left side becomes <code>y(t)</code>, and the right side becomes the integral of <code>b*x(tau) - a*y(tau)</code>.</p>
<p>In the block diagram: <code>x(t)</code> is multiplied by <code>b</code>. <code>y(t)</code> is multiplied by <code>-a</code>. These two signals are added together. The sum is then fed into an integrator. The output of the integrator is <code>y(t)</code>. Again, we see a feedback loop where <code>y(t)</code> is fed back to influence its own derivative. The integrator is the system’s memory, storing its past values. This type of block diagram directly forms the basis of historical analog computers and remains a fundamental way to understand continuous-time system implementation.</p>
</div>
<hr>
</section>
<section id="basic-elements-of-block-diagram-1" class="level2">
<h2 class="anchored" data-anchor-id="basic-elements-of-block-diagram-1">Basic Elements of Block Diagram</h2>
<ol type="a">
<li>an adder; (b) multiplication by a coefficient; (c) a differentiator; (d) overall representation using differentiator; (d) overall representation using integrator</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=192&amp;width=636&amp;top_left_y=246&amp;top_left_x=397" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=77&amp;width=531&amp;top_left_y=564&amp;top_left_x=411" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=134&amp;width=545&amp;top_left_y=782&amp;top_left_x=414" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="3" type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-156.jpg?height=309&amp;width=577&amp;top_left_y=1027&amp;top_left_x=472" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="4" type="a">
<li></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn.mathpix.com/cropped/2024_02_14_ad5c48a840b9702e9410g-158.jpg?height=438&amp;width=644&amp;top_left_y=251&amp;top_left_x=512" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<ol start="5" type="a">
<li></li>
</ol>
<hr>
</section>
<section id="continous-system-in-differential-equations" class="level2">
<h2 class="anchored" data-anchor-id="continous-system-in-differential-equations">Continous System in Differential Equations</h2>
<p><strong>Mass–Spring System (Oscillator)</strong></p>
<p>A mass attached to a spring (ignoring friction first).</p>
<ul>
<li>Hooke’s law: restoring force <span class="math inline">\(F = -kx\)</span></li>
<li>Newton’s second law: <span class="math inline">\(F = m \dfrac{d^2x}{dt^2}\)</span></li>
</ul>
<p>So:</p>
<p><span class="math display">\[
m \frac{d^2x}{dt^2} + kx = 0
\]</span></p>
<p>This <strong>second-order ODE</strong> governs the oscillation. Its solution is sinusoidal:</p>
<p><span class="math display">\[
x(t) = A \cos(\omega t) + B \sin(\omega t), \quad \omega = \sqrt{\tfrac{k}{m}}
\]</span></p>
<hr>
</section>
<section id="continous-system-in-differential-equations-1" class="level2">
<h2 class="anchored" data-anchor-id="continous-system-in-differential-equations-1">Continous System in Differential Equations</h2>
<p><strong>RC Circuit (Charging a Capacitor)</strong></p>
<p>A resistor <span class="math inline">\(R\)</span> and capacitor <span class="math inline">\(C\)</span> in series with a voltage source <span class="math inline">\(V\)</span>. Kirchhoff’s law:</p>
<p><span class="math display">\[
V = V_R + V_C = Ri(t) + \frac{q(t)}{C}
\]</span></p>
<p>Since <span class="math inline">\(i(t) = \dfrac{dq}{dt}\)</span>:</p>
<p><span class="math display">\[
R \frac{dq}{dt} + \frac{q}{C} = V
\]</span></p>
<p>This <strong>first-order ODE</strong> models how charge (and voltage across capacitor) evolves. The solution is exponential:</p>
<p><span class="math display">\[
q(t) = CV \left(1 - e^{-t/RC}\right)
\]</span></p>
<p><strong>Pendulum (Nonlinear System)</strong></p>
<p>For a pendulum of length <span class="math inline">\(L\)</span>, angle <span class="math inline">\(\theta(t)\)</span>:</p>
<p><span class="math display">\[
\frac{d^2 \theta}{dt^2} + \frac{g}{L}\sin(\theta) = 0
\]</span></p>
<p>This is a <strong>nonlinear ODE</strong> (due to <span class="math inline">\(\sin\theta\)</span>).</p>
<hr>
</section>
<section id="discrete-system-in-difference-equations" class="level2">
<h2 class="anchored" data-anchor-id="discrete-system-in-difference-equations">Discrete System in Difference Equations</h2>
<p><strong>Digital RC Circuit (Discrete Approximation)</strong></p>
<p>If you sample the continuous RC circuit at time steps of length <span class="math inline">\(\Delta t\)</span>, the capacitor voltage <span class="math inline">\(v[n]\)</span> satisfies a first-order <strong>difference equation</strong>:</p>
<p><span class="math display">\[
v[n+1] = \left(1 - \frac{\Delta t}{RC}\right) v[n] + \frac{\Delta t}{RC} V
\]</span></p>
<p>This models how the voltage changes step by step in a digital simulation.</p>
</section>
<section id="spring-mass-system-with-numerical-integration" class="level2">
<h2 class="anchored" data-anchor-id="spring-mass-system-with-numerical-integration"><strong>Spring-Mass System with Numerical Integration</strong></h2>
<p>Discretizing Newton’s second law for a spring–mass:</p>
<p><span class="math display">\[
m \frac{d^2x}{dt^2} = -kx
\]</span></p>
<p>Using finite differences (<span class="math inline">\(x_{n+1} - 2x_n + x_{n-1}\)</span>/<span class="math inline">\(\Delta t^2\)</span>):</p>
<p><span class="math display">\[
x_{n+1} = 2x_n - x_{n-1} - \frac{k}{m} \Delta t^2 \, x_n
\]</span></p>
<p>This is a <strong>second-order difference equation</strong> that simulates oscillations step by step.</p>
<p><strong>Control Systems (Z-Domain Models)</strong></p>
<p>Digital controllers (like in robotics or motor drives) are governed by difference equations. Example: A discrete-time first-order system:</p>
<p><span class="math display">\[
y[n+1] = a y[n] + b u[n]
\]</span></p>
<p>where <span class="math inline">\(y[n]\)</span> is system output and <span class="math inline">\(u[n]\)</span> is input at time step <span class="math inline">\(n\)</span>.</p>
<hr>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li><strong>LCCDEs</strong> are fundamental for describing causal LTI systems in both continuous and discrete domains.</li>
<li>Solving involves finding a <strong>particular solution</strong> (forced response) and a <strong>homogeneous solution</strong> (natural response).</li>
<li><strong>Auxiliary conditions</strong>, particularly the <strong>condition of initial rest</strong>, are crucial for unique, causal, and LTI solutions.</li>
<li>Discrete-time systems are categorized as <strong>Recursive (IIR)</strong> or <strong>Nonrecursive (FIR)</strong> based on output dependence.</li>
<li><strong>Block diagrams</strong> (using adders, multipliers, delays/integrators) provide valuable visual understanding and aid implementation.</li>
<li><strong>Ahead:</strong> We will develop more powerful frequency-domain tools (e.g., Laplace and Z-transforms) to simplify solving these equations and further analyze complex system properties.</li>
</ul>
<div class="notes">
<p>To summarize, differential and difference equations are the bedrock for modeling LTI causal systems. We’ve learned that solving them involves combining a particular solution, driven by the input, with a homogeneous solution, representing the system’s natural behavior. Initial rest is the key auxiliary condition for ensuring the crucial properties of causality and LTI. We also explored the distinction between FIR and IIR systems in discrete time and saw how block diagrams offer a powerful visual and practical representation. In the coming chapters, we’ll build on this foundation by introducing frequency-domain transforms that will provide even more efficient and insightful ways to analyze these complex and fascinating systems. Thank you.</p>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBLX3NsaWRlciA9IElucHV0cy5yYW5nZShbMCwgMTBdLCB7XG4gIGxhYmVsOiBodG1sYDxzcGFuIHN0eWxlPVwiZm9udC1zaXplOiAwLjhlbTtcIj5BbXBsaXR1ZGUgSzwvc3Bhbj5gLFxuICBzdGVwOiAxLFxuICB2YWx1ZTogNSxcbn0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGFscGhhX3NsaWRlciA9IElucHV0cy5yYW5nZShbLTAuOSwgMC45XSwge1xuICBsYWJlbDogaHRtbGA8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogMC44ZW07XCI+Q29lZmZpY2llbnQgJ2EnPC9zcGFuPmAsXG4gIHN0ZXA6IDAuMSxcbiAgdmFsdWU6IDAuNSxcbn0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdLX3NsaWRlcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhbHBoYV9zbGlkZXInKSJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>