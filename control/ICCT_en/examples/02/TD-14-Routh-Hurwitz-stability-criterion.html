<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Routh and Hurwitz stability criterion – Instrumentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Instrumentation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#how-to-use-this-notebook" id="toc-how-to-use-this-notebook" class="nav-link active" data-scroll-target="#how-to-use-this-notebook">How to use this notebook?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Routh and Hurwitz stability criterion</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="63">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erasmus+ ICCT project (2018-1-SI01-KA203-047081)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Toggle cell visibility</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>tag <span class="op">=</span> HTML(<span class="st">'''&lt;script&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">code_show=true; </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">function code_toggle() {</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">    if (code_show){</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">        $('div.input').hide()</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">        $('div.input').show()</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">    code_show = !code_show</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">} </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="st">$( document ).ready(code_toggle);</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/script&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">Toggle cell visibility &lt;a href="javascript:code_toggle()"&gt;here&lt;/a&gt;.'''</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>display(tag)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Hide the code completely</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># from IPython.display import HTML</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># tag = HTML('''&lt;style&gt;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># div.input {</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     display:none;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;/style&gt;''')</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># display(tag)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<script>
code_show=true; 
function code_toggle() {
    if (code_show){
        $('div.input').hide()
    } else {
        $('div.input').show()
    }
    code_show = !code_show
} 
$( document ).ready(code_toggle);
</script>
Toggle cell visibility <a href="javascript:code_toggle()">here</a>.
</div>
</div>
<div id="cell-2" class="cell" data-execution_count="64">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp <span class="co"># Symbolic Python</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># Arrays, matrices and corresponding mathematical operations</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Latex, display, Markdown, clear_output <span class="co"># For displaying Markdown and LaTeX code</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> widgets <span class="co"># Interactivity module</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Javascript</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for the conversion of array/matrix to LaTeX/Markdown format.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vmatrix(a):</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(a.shape) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'bmatrix can at most display two dimensions'</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> <span class="bu">str</span>(a).replace(<span class="st">'['</span>, <span class="st">''</span>).replace(<span class="st">']'</span>, <span class="st">''</span>).splitlines()</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    rv <span class="op">=</span> [<span class="vs">r'</span><span class="dv">\b</span><span class="vs">egin{vmatrix}'</span>]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    rv <span class="op">+=</span> [<span class="st">'  '</span> <span class="op">+</span> <span class="st">' &amp; '</span>.join(l.split()) <span class="op">+</span> <span class="vs">r'</span><span class="ch">\\</span><span class="vs">'</span> <span class="cf">for</span> l <span class="kw">in</span> lines]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    rv <span class="op">+=</span>  [<span class="vs">r'</span><span class="er">\</span><span class="vs">end{vmatrix}'</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(rv)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In control system theory, the Routh–Hurwitz stability criterion is a mathematical test used to detect the number of poles of the closed-loop transfer function that have positive real parts. The number of the sign changes in the first column of the Routh array gives the number of poles in the right half of the complex plane. The necessary and sufficient condition for the stability of a linear time-invariant control system is that all closed-loop system poles have negative real parts. That means that there should be no changes of sign in the first column. A similar stability criterion based on the determinants of a system is called Hurwitz criterion.</p>
<p>The starting point for determining system stability is the characteristic polynmial defined as:</p>
<p><span class="math display">\[\begin{equation}
    a_ns^n+a_{n-1}s^{n-1}+...+a_1s+a_0
\end{equation}\]</span></p>
<p>In the case of the Routh’s criterion we then form the so called Routh’s array:</p>
<span class="math display">\[\begin{array}{l|ccccc}
     &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\
     \hline
    s^n &amp; a_n &amp; a_{n-2} &amp; a_{n-4} &amp; a_{n-6} &amp; \dots \\
    s^{n-1} &amp; a_{n-1} &amp; a_{n-3} &amp; a_{n-5} &amp; a_{n-7} &amp;\dots \\
    s^{n-2} &amp; b_1 &amp; b_2 &amp; b_3 &amp; b_4 &amp; \dots \\
    s^{n-3} &amp; c_1 &amp; c_2 &amp; c_3 &amp; c_4 &amp; \dots \\
    s^{n-4} &amp; d_1 &amp; d_2 &amp; d_3 &amp; d_4 &amp; \dots \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots\\
\end{array}\]</span>
<p>The coefficients in the first two rows (<span class="math inline">\(a_i\)</span>) are obtained from the characteristic polynomial. All the others are determined using the following formulae:</p>
<span class="math display">\[\begin{array}{cccc}
    \,  \! \! \! \! b_1 \! = \! \frac{a_{n-1}a_{n-2}-a_n a_{n-3}}{a_{n-1}} &amp; \! \!  \! \! \,  \! \! b_2 \!  = \!  \frac{a_{n-1}a_{n-4}-a_n a_{n-5}}{a_{n-1}} &amp; \,  \! \! b_3 \! = \! \frac{a_{n-1}a_{n-6}-a_n a_{n-7}}{a_{n-1}} &amp; \, \! \! \! \! \dots \\
     c_1=\frac{b_1a_{n-3}-a_{n-1} b_2}{b_1} &amp; c_2=\frac{b_1a_{n-5}-a_{n-1}b_3}{b_1} &amp; c_3=\frac{b_1a_{n-7}-a_{n-1}b_4}{b_1} &amp; \, \! \! \! \! \dots \\
     d_1=\frac{c_1 b_2-b_1 c_2}{c_1} &amp; d_2=\frac{c_1 b_3-b_1 c_3}{c_1} &amp; d_3=\frac{c_1 b_4-b_1 c_4}{c_1} &amp; \, \! \! \! \! \dots \\
    \vdots &amp; \vdots &amp; \vdots &amp; \, \! \! \! \! \ddots \\
\end{array}\]</span>
<p>If all coefficients in the first column (<span class="math inline">\(n+1\)</span> coefficients) have the same sign (either all are positive or all are negative), the system is stable. The number of sign changes in the first column gives us the number of the roots of the characteristic polynomial that lie in the left half of the complex plane.</p>
<p>In the case of the Hurwitz criterion a determinant <span class="math inline">\(\Delta_n\)</span> with the dimensions <span class="math inline">\(n\times n\)</span> is formed based on the characteristic polynomial.</p>
<p><span class="math display">\[\begin{equation}
    \Delta_n=
    \begin{array}{|cccccccc|}
        a_{n-1} &amp; a_{n-3} &amp; a_{n-5} &amp; \dots &amp; \left[ \begin{array}{cc} a_0 &amp; \mbox{if
        }n \mbox{ is odd} \\ a_1 &amp; \mbox{if }n \mbox{ is even} \end{array}
        \right] &amp; 0 &amp; \dots &amp; 0  \\[3mm]
        a_{n} &amp; a_{n-2} &amp; a_{n-4} &amp; \dots &amp; \left[ \begin{array}{cc} a_1 &amp; \mbox{if }n \mbox{ is odd} \\ a_0 &amp; \mbox{if }n \mbox{ is even} \end{array} \right] &amp; 0 &amp; \dots &amp; 0 \\
        0 &amp; a_{n-1} &amp; a_{n-3} &amp; a_{n-5} &amp; \dots &amp;  \dots &amp; \dots &amp; 0 \\
        0 &amp; a_{n} &amp; a_{n-2} &amp; a_{n-4} &amp; \dots &amp;  \dots &amp; \dots &amp; 0 \\
        0 &amp; 0 &amp; a_{n-1} &amp; a_{n-3} &amp; \dots &amp;  \dots &amp; \dots &amp; 0 \\
        0 &amp; 0 &amp; a_{n} &amp; a_{n-2} &amp; \dots &amp;  \dots &amp; \dots &amp; 0 \\
        \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
        0 &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; a_0 \\
    \end{array}
\end{equation}\]</span></p>
<p>Based on the determinant <span class="math inline">\(\Delta_n\)</span> we form the subdeterminants on the main diagonal. The subdeterminant <span class="math inline">\(\Delta_1\)</span> is equal to</p>
<p><span class="math display">\[\begin{equation}
    \Delta_1=a_{n-1},
\end{equation}\]</span></p>
<p>subdterminant <span class="math inline">\(\Delta_2\)</span> to</p>
<p><span class="math display">\[\begin{equation}
    \Delta_2=
    \begin{array}{|cc|}
    a_{n-1} &amp; a_{n-3} \\
    a_{n} &amp; a_{n-2} \\
    \end{array},
\end{equation}\]</span></p>
<p>and subdeterminant <span class="math inline">\(\Delta_3\)</span> to</p>
<p><span class="math display">\[\begin{equation}
    \Delta_3=
    \begin{array}{|ccc|}
    a_{n-1} &amp; a_{n-3} &amp; a_{n-5} \\
    a_{n} &amp; a_{n-2} &amp; a_{n-4} \\
    0 &amp; a_{n-1} &amp; a_{n-3} \\
    \end{array}.
\end{equation}\]</span></p>
<p>We continue in this manner until we get to the subdeterminant <span class="math inline">\(\Delta_{n-1}\)</span>. The system is stable if all subdeterminants on the main diagonal (from <span class="math inline">\(\Delta_1\)</span> to <span class="math inline">\(\Delta_{n-1}\)</span>) as well as the determinant <span class="math inline">\(\Delta_n\)</span> are strictly larger than zero.</p>
<hr>
<section id="how-to-use-this-notebook" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-this-notebook">How to use this notebook?</h3>
<p>Please define the characteristic polynomial of interest by inserting its order and the corresponding coefficients, and then choosing the desired stabiliy criterion (Routh or Hurwitz).</p>
<div id="cell-4" class="cell" data-scrolled="false" data-execution_count="70">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>polynomialOrder <span class="op">=</span> <span class="bu">input</span> (<span class="st">"Insert the order of the characteristic polynomial (press Enter to confirm):"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    val <span class="op">=</span> <span class="bu">int</span>(polynomialOrder)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    display(Markdown(<span class="st">'Order of the polynomial has to be an integer. Please re-enter the value.+'</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="st">'Please insert the coefficients of the characteristic polynomial (use $K$ for undefined coefficient) and click "Confirm".'</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>text<span class="op">=</span>[<span class="va">None</span>]<span class="op">*</span>(<span class="bu">int</span>(polynomialOrder)<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(polynomialOrder)<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    text[i]<span class="op">=</span>widgets.Text(description<span class="op">=</span>(<span class="st">'$s^</span><span class="sc">%i</span><span class="st">$'</span><span class="op">%</span>(<span class="op">-</span>(i<span class="op">-</span><span class="bu">int</span>(polynomialOrder)))))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    display(text[i])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>btn1<span class="op">=</span>widgets.Button(description<span class="op">=</span><span class="st">"Confirm"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>btnReset<span class="op">=</span>widgets.Button(description<span class="op">=</span><span class="st">"Reset"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>display(widgets.HBox((btn1, btnReset)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>btn2<span class="op">=</span>widgets.Button(description<span class="op">=</span><span class="st">"Confirm"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>w<span class="op">=</span>widgets.Select(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    options<span class="op">=</span>[<span class="st">'Routh'</span>, <span class="st">'Hurwitz'</span>],</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    rows<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">'Select:'</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    disabled<span class="op">=</span><span class="va">False</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>coef<span class="op">=</span>[<span class="va">None</span>]<span class="op">*</span>(<span class="bu">int</span>(polynomialOrder)<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_button_clickedReset(ev):</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    display(Javascript(<span class="st">"Jupyter.notebook.execute_cells_below()"</span>))</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_button_clicked1(btn1):</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    clear_output()</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(polynomialOrder)<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> text[i].value<span class="op">==</span><span class="st">''</span> <span class="kw">or</span> text[i].value<span class="op">==</span><span class="st">'Please insert a coefficient'</span>:</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>            text[i].value<span class="op">=</span><span class="st">'Please insert a coefficient'</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                coef[i]<span class="op">=</span><span class="bu">float</span>(text[i].value)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> text[i].value<span class="op">!=</span><span class="st">''</span> <span class="kw">or</span> text[i].value<span class="op">!=</span><span class="st">'Please insert a coefficient'</span>:</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                    coef[i]<span class="op">=</span>sp.var(text[i].value)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    coef.reverse()</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    enacba<span class="op">=</span><span class="st">"$"</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (<span class="bu">int</span>(polynomialOrder),<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i<span class="op">==</span><span class="bu">int</span>(polynomialOrder):</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>            enacba<span class="op">=</span>enacba<span class="op">+</span><span class="bu">str</span>(coef[i])<span class="op">+</span><span class="st">"s^"</span><span class="op">+</span><span class="bu">str</span>(i)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> i<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>            enacba<span class="op">=</span>enacba<span class="op">+</span><span class="st">"+"</span><span class="op">+</span><span class="bu">str</span>(coef[i])<span class="op">+</span><span class="st">"s"</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> i<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>            enacba<span class="op">=</span>enacba<span class="op">+</span><span class="st">"+"</span><span class="op">+</span><span class="bu">str</span>(coef[i])<span class="op">+</span><span class="st">"$"</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            enacba<span class="op">=</span>enacba<span class="op">+</span><span class="st">"+"</span><span class="op">+</span><span class="bu">str</span>(coef[i])<span class="op">+</span><span class="st">"s^"</span><span class="op">+</span><span class="bu">str</span>(i)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    coef.reverse()</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    display(Markdown(<span class="st">'The characteristic polynomial of interest is:'</span>), Markdown(enacba))</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    display(Markdown(<span class="st">'Would you like to use Routh or Hurwitz criterion to check the stability?'</span>))</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    display(w)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    display(widgets.HBox((btn2, btnReset)))</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    display(out)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> on_button_clicked2(btn2):</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> w.value<span class="op">==</span><span class="st">'Routh'</span>:</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        s<span class="op">=</span>np.zeros((<span class="bu">len</span>(coef), <span class="bu">len</span>(coef)<span class="op">//</span><span class="dv">2</span><span class="op">+</span>(<span class="bu">len</span>(coef)<span class="op">%</span><span class="dv">2</span>)),dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        xx<span class="op">=</span>np.zeros((<span class="bu">len</span>(coef), <span class="bu">len</span>(coef)<span class="op">//</span><span class="dv">2</span><span class="op">+</span>(<span class="bu">len</span>(coef)<span class="op">%</span><span class="dv">2</span>)),dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        check_index<span class="op">=</span><span class="dv">0</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(s[<span class="dv">0</span>]) <span class="op">==</span> <span class="bu">len</span>(coef[::<span class="dv">2</span>]):</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>            s[<span class="dv">0</span>] <span class="op">=</span> coef[::<span class="dv">2</span>]</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">len</span>(s[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span> <span class="op">==</span> <span class="bu">len</span>(coef[::<span class="dv">2</span>]):</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>            s[<span class="dv">0</span>,:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> coef[::<span class="dv">2</span>]</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">#soda mesta</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(s[<span class="dv">1</span>]) <span class="op">==</span> <span class="bu">len</span>(coef[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>            s[<span class="dv">1</span>] <span class="op">=</span> coef[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">len</span>(s[<span class="dv">1</span>])<span class="op">-</span><span class="dv">1</span> <span class="op">==</span> <span class="bu">len</span>(coef[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>            s[<span class="dv">1</span>,:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> coef[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s[<span class="dv">2</span>:,:])):</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>            i<span class="op">+=</span><span class="dv">2</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s[<span class="dv">0</span>,<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>])):</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>                s[i,j] <span class="op">=</span> (s[i<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>]<span class="op">*</span>s[i<span class="op">-</span><span class="dv">2</span>,j<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>s[i<span class="op">-</span><span class="dv">2</span>,<span class="dv">0</span>]<span class="op">*</span>s[i<span class="op">-</span><span class="dv">1</span>,j<span class="op">+</span><span class="dv">1</span>]) <span class="op">/</span> s[i<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>]</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> s[i,<span class="dv">0</span>] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>                    epsilon<span class="op">=</span>sp.Symbol(<span class="st">'</span><span class="ch">\u03B5</span><span class="st">'</span>)</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>                    s[i,<span class="dv">0</span>] <span class="op">=</span> epsilon</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>                    check_index<span class="op">=</span><span class="dv">1</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> check_index<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s)):</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s[<span class="dv">0</span>])):</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>                    xx[i,j] <span class="op">=</span> sp.limit(s[i,j],epsilon,<span class="dv">0</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>            positive_check<span class="op">=</span>xx[:,<span class="dv">0</span>]<span class="op">&gt;</span><span class="dv">0</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>            negative_check<span class="op">=</span>xx[:,<span class="dv">0</span>]<span class="op">&lt;</span><span class="dv">0</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(positive_check)<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>                    clear_output()</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'One of the elements in the first column of the Routh table is equal to 0. We replace it with $</span><span class="er">\</span><span class="st">epsilon$ and observe the values of the elements when $</span><span class="er">\</span><span class="st">epsilon$ goes to zero.'</span>)) </span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'System is stable, because all the elements in the first column of the Routh table are positive.'</span>))</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> vmatrix(xx)))</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">all</span>(negative_check)<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                    clear_output()</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'One of the elements in the first column of the Routh table is equal to 0. We replace it with $</span><span class="er">\</span><span class="st">epsilon$ and observe the values of the elements when $</span><span class="er">\</span><span class="st">epsilon$ goes to zero.'</span>)) </span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'System is stable, because all the elements in the first column of the Routh table are negative.'</span>))</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> vmatrix(xx)))           </span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>                    clear_output()</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'One of the elements in the first column of the Routh table is equal to 0. We replace it with $</span><span class="er">\</span><span class="st">epsilon$ and observe the values of the elements when value of $</span><span class="er">\</span><span class="st">epsilon$ goes to zero.'</span>)) </span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'System is unstable, because the elements in the first column of the Routh table do not have the same sign.'</span>))</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$</span><span class="ch">\n</span><span class="st">'</span> <span class="op">%</span> vmatrix(xx)))</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> check_index<span class="op">==</span><span class="dv">0</span>:      </span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(<span class="bu">isinstance</span>(x, (<span class="bu">int</span>,<span class="bu">float</span>)) <span class="cf">for</span> x <span class="kw">in</span> coef):</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>                positive_check<span class="op">=</span>s[:,<span class="dv">0</span>]<span class="op">&gt;</span><span class="dv">0</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>                negative_check<span class="op">=</span>s[:,<span class="dv">0</span>]<span class="op">&lt;</span><span class="dv">0</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">all</span>(positive_check)<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> out:</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>                        clear_output()</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'System is stable, because all the elements in the first column of the Routh table are positive.'</span>))</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="bu">all</span>(negative_check)<span class="op">==</span><span class="va">True</span>:</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> out:</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>                        clear_output()</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'System is stable, because all the elements in the first column of the Routh table are negative.'</span>))</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> out:</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>                        clear_output()</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'System is unstable, because the elements in the first column of the Routh table do not have the same sign.'</span>))</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>                testSign<span class="op">=</span>[]</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(s)):</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(s[i,<span class="dv">0</span>],(<span class="bu">int</span>,<span class="bu">float</span>)):</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>                        testSign.append(s[i,<span class="dv">0</span>]<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>                solution<span class="op">=</span>[]</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">all</span>(elem <span class="op">==</span> <span class="va">True</span> <span class="cf">for</span> elem <span class="kw">in</span> testSign):</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> x <span class="kw">in</span> s[:,<span class="dv">0</span>]:</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(x,(sp.numbers.Integer,sp.numbers.Float,<span class="bu">int</span>,<span class="bu">float</span>)):</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>                            solution.append(sp.solve(x<span class="op">&gt;</span><span class="dv">0</span>,K)) <span class="co"># Define the solution for each value of the determinant</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> out:</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>                        clear_output()</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'All the known coefficients in the first column of Routh table are positive, therefore the system is stable for:'</span>))</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(solution)            </span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="bu">all</span>(elem <span class="op">==</span> <span class="va">False</span> <span class="cf">for</span> elem <span class="kw">in</span> test):</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> x <span class="kw">in</span> s[:,<span class="dv">0</span>]:</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(x,(sp.numbers.Integer,sp.numbers.Float,<span class="bu">int</span>,<span class="bu">float</span>)):</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>                            solution.append(sp.solve(x<span class="op">&lt;</span><span class="dv">0</span>,K)) <span class="co"># Define the solution for each value of the determinant</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> out:</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>                        clear_output()</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'All the known coefficients in the first column of Routh table are negative, therefore the system is stable for:'</span>))</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(solution)</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> out:</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'Routh table $</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span> vmatrix(s)))</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'System is unstable, beacuse the signs of the coefficients in the first column differ between each other.'</span>))</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> w.value<span class="op">==</span><span class="st">'Hurwitz'</span>:</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if all the coefficients are numbers or not and preallocate basic determinant.</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">all</span>(<span class="bu">isinstance</span>(x, (<span class="bu">int</span>,<span class="bu">float</span>)) <span class="cf">for</span> x <span class="kw">in</span> coef):</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>            determinant<span class="op">=</span>np.zeros([<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>,<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>            determinant<span class="op">=</span>np.zeros([<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>,<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>],dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Define the first two rows of the basic determinant.    </span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>                determinant[<span class="dv">0</span>,i]<span class="op">=</span>coef[<span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>                determinant[<span class="dv">0</span>,i]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>                determinant[<span class="dv">1</span>,i]<span class="op">=</span>coef[<span class="dv">2</span><span class="op">*</span>i]</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>                determinant[<span class="dv">1</span>,i]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Define the remaining rows of the basic determinant by shifting the first two rows.        </span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>,<span class="bu">len</span>(coef)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>            determinant[i,:]<span class="op">=</span>np.roll(determinant[i<span class="op">-</span><span class="dv">2</span>,:],<span class="dv">1</span>)</span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>            determinant[<span class="dv">2</span>:,<span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Define all the subdeterminants.</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>        subdet<span class="op">=</span>[]<span class="op">;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(determinant)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>            subdet.append(determinant[<span class="dv">0</span>:i<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span>:i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the basic determinant to the subdeterminants' array.</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>        subdet.append(determinant)</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if all coefficients are numbers.</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">all</span>(<span class="bu">isinstance</span>(x, (<span class="bu">int</span>,<span class="bu">float</span>)) <span class="cf">for</span> x <span class="kw">in</span> coef):</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>            det_value<span class="op">=</span>[] <span class="co"># Preallocate array containing values of all determinants.</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subdet)):</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>                det_value.append(np.linalg.det(subdet[i]))<span class="op">;</span> <span class="co"># Calculate determinant and append the values to det_value.</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(i <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> det_value)<span class="op">==</span><span class="va">True</span>: <span class="co"># Check if all values in det_value are positive or not.</span></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>                    clear_output()</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'System is stable, because all determinants are positive.'</span>))</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subdet)):</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'$</span><span class="er">\</span><span class="st">Delta_{</span><span class="sc">%i</span><span class="st">}=$'</span><span class="op">%</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> <span class="st">'$</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>vmatrix(subdet[i]) <span class="op">+</span> <span class="st">'$=</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>det_value[i]))</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>                    clear_output()</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'System is unstable, because not all determinants are positive.'</span>))</span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subdet)):</span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>                        display(Markdown(<span class="st">'$</span><span class="er">\</span><span class="st">Delta_{</span><span class="sc">%i</span><span class="st">}=$'</span><span class="op">%</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> <span class="st">'$</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>vmatrix(subdet[i]) <span class="op">+</span> <span class="st">'$=</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>det_value[i]))</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>            subdetSym<span class="op">=</span>[] <span class="co"># Preallocate subdetSym.</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>            det_value<span class="op">=</span>[] <span class="co"># Preallocate det_value.</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>            solution<span class="op">=</span>[] <span class="co"># Preallocate solution.</span></span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> subdet:</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>                subdetSym.append(sp.Matrix(i)) <span class="co"># Transform matrix subdet to symbolic.</span></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subdetSym)):</span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>                det_value.append(subdetSym[i].det()) <span class="co"># Calculate the value of the determinant.</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>            testSign<span class="op">=</span>[]</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(det_value)):</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(det_value[i],(<span class="bu">int</span>,<span class="bu">float</span>,sp.numbers.Integer,sp.numbers.Float)):</span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>                    testSign.append(det_value[i]<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(elem <span class="op">==</span> <span class="va">True</span> <span class="cf">for</span> elem <span class="kw">in</span> testSign):</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>                solution<span class="op">=</span>[]</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> x <span class="kw">in</span> det_value:</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(x,(sp.numbers.Integer,sp.numbers.Float,<span class="bu">int</span>,<span class="bu">float</span>)):</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>                        solution.append(sp.solve(x<span class="op">&gt;</span><span class="dv">0</span>,K)) <span class="co"># Define the solution for each value of the determinant</span></span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>                    clear_output()                    </span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subdet)):</span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'$</span><span class="er">\</span><span class="st">Delta_{</span><span class="sc">%i</span><span class="st">}=$'</span><span class="op">%</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> <span class="st">'$</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>vmatrix(subdet[i]) <span class="op">+</span> <span class="st">'$=</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>det_value[i]))</span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>                display(Markdown(<span class="st">'System is stable, for:'</span>))</span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(solution)    </span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> out:</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>                    clear_output()</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'System is unstable, because not all known determinants are positive.'</span>))</span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subdet)):</span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>                    display(Markdown(<span class="st">'$</span><span class="er">\</span><span class="st">Delta_{</span><span class="sc">%i</span><span class="st">}=$'</span><span class="op">%</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> <span class="st">'$</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>vmatrix(subdet[i]) <span class="op">+</span> <span class="st">'$=</span><span class="sc">%s</span><span class="st">$'</span> <span class="op">%</span>det_value[i]))</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> out</span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>out<span class="op">=</span>widgets.Output()</span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>btn3<span class="op">=</span>widgets.Button(description<span class="op">=</span><span class="st">"Reset all"</span>)</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>w<span class="op">=</span>widgets.Select(</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>    options<span class="op">=</span>[<span class="st">'Routh'</span>, <span class="st">'Hurwitz'</span>],</span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>    rows<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">'Select:'</span>,</span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>    disabled<span class="op">=</span><span class="va">False</span></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>btn1.on_click(on_button_clicked1)</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>btn2.on_click(on_button_clicked2)       </span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>btnReset.on_click(on_button_clickedReset) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown">
<p>The characteristic polynomial of interest is:</p>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\(1.0s^3+1.0s^2+2.0s+8.0\)</span></p>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p>Would you like to use Routh or Hurwitz criterion to check the stability?</p>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"97bb1a4ed4674ce49cbd90b782cf585f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"148985d08b9245e0b70546ab9e4fae8a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c56780825db047b3a34dd867adfd7d44","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>